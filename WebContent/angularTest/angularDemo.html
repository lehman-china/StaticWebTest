<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>前端JS框架angular,增,删,查,改,排序, 例子</title>

<script src="../common/js/inc/jquery-1.8.3.min.js"></script>

<!--  bootstrap css样式  美观,不用自己写样式 -->
<link rel="stylesheet" href="../common/css/bootstrap.min.css">
<!-- 引入他的框架JS 即可 -->
<script src="../common/js/inc/angular.min.js"></script>


<script>
	var g_users = {};
	var app = angular.module( 'myapp', [] );
	/* js 代码, 就是个方法.  称做:angular的控制器  */
	app.controller( "userController", function( $scope, $http ) {
		$scope.selUser = {};

		// 数据源
		$scope.users = [];

		$http( {
			url : "data/users.json",
			method : "get"
		} ).success( function( res ) {
			console.log( res );
			console.log( angular.toJson(res) );
		} );

		g_users = $scope.users;
		$scope.editUser = function( id ) {
			$scope.selUser = $scope.users[getIndex( id )];
		};
		$scope.deleteUser = function( id ) {
			$scope.users.splice( getIndex( id ), 1 );
		};
		$scope.addUser = function() {
			var user = {
				id : new Date().getTime(),
				name : $scope.selUser.name,
				age : $scope.selUser.age
			};
			$scope.users.push( user );
		};
		$scope.order = function( title ) {
			$scope.users.sort( function( a, b ) {
				return a[title] > b[title] ? 1 : -1;
			} );
		};
		/**
		 * 以userID ,查询对象在数组的索引位置
		 */
		function getIndex( id ) {
			for ( i in $scope.users ) {
				var user = $scope.users[i];
				if ( user.id == id ) {
					return i;
				}
			}
			return null;
		}
		/*// 监听变量, 变更 selUser 的值就会响应方法
		 $scope.$watch( 'selUser', function() {
		 	alert( "测试监听指令:" );
		 } );
		 */
	} );
	function deleteUser2() {
		delete g_users.splice( 1, 1 );
	}
</script>
</head>
<!-- html 代码  -->
<body ng-app="myapp" ng-controller="userController">
	<div class="container">

		<h1 style="color: red;">前端JS框架angular,增,删,查,改,排序, 例子</h1>
		作者:雷建军2014-9-13 12:58:44
		<h5>
			(我们只用jQuery编写一个简单的增,删,查,改,排序的例子.需要多少代码?需要选择多少次元素?需要自己控制多少次HTML?<br> 简直太繁琐!把人搞醉.<br> 让我们来看看前端 JS框架 angularJS,是怎么做的. 看完效果后,查看源代码即可.)
		</h5>

		<h3>用户列表</h3>
		<table class="table table-striped  table-bordered">
			<thead>
				<tr>
					<th>操作</th>
					<th><a href="javascript:" ng-click="order('id')"> 编号<span class="glyphicon glyphicon-sort-by-attributes"></span></a></th>
					<th><a href="javascript:" ng-click="order('name')">名称<span class="glyphicon glyphicon-sort-by-attributes"></span></a></th>
					<th><a href="javascript:" ng-click="order('age')"> 年龄<span class="glyphicon glyphicon-sort-by-attributes"></span></a></th>
				</tr>
			</thead>
			<tbody>
				<tr ng-repeat="user in users">
					<td>
						<button class="btn  btn-info" ng-click="editUser(user.id)">
							<span class="glyphicon glyphicon-pencil"></span>编辑
						</button>
						<button class="btn btn-danger" ng-click="deleteUser(user.id)">
							<span class="glyphicon glyphicon-trash"></span> 删除
						</button>
					</td>
					<td>{{ user.id }}</td>
					<td>{{ user.name }}</td>
					<td>{{ user.age }}</td>
				</tr>
			</tbody>
		</table>
		<h3>创建新用户:</h3>
		<form class="form-horizontal">
			<div class="form-group">
				<label class="col-sm-2 control-label">编号:</label>
				<div class="col-sm-10">
					<input type="text" ng-model="selUser.id" ng-disabled="true" placeholder="编号">
				</div>
			</div>
			<div class="form-group">
				<label class="col-sm-2 control-label">名称:</label>
				<div class="col-sm-10">
					<input type="text" ng-model="selUser.name" placeholder="名称">
				</div>
			</div>
			<div class="form-group">
				<label class="col-sm-2 control-label">年龄:</label>
				<div class="col-sm-10">
					<input type="text" ng-model="selUser.age" placeholder="年龄">
				</div>
			</div>
		</form>
		<hr>
		<button class="btn btn-success" ng-click="addUser()">
			<span class="glyphicon glyphicon-user"></span>创建新用户
		</button>
		<button class="btn btn-success" onclick="deleteUser2()">
			<span class="glyphicon glyphicon-user"></span>delete
		</button>
	</div>

</body>
</html>
